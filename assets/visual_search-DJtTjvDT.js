import"./modulepreload-polyfill-B5Qt9EMX.js";const i={btn:document.getElementById("ignite-btn"),grid:document.getElementById("grid-container"),loader:document.getElementById("loader")},$=["STM32","ESP32","LM","TPS","MAX","ADS","INA","LTC","BME","V","SX","DRV","AT"];let l=[],d=!1;function s(e,t){return Math.floor(Math.random()*(t-e)+e)}function a(){return String.fromCharCode(97+Math.floor(Math.random()*26))}function m(e){return e[Math.floor(Math.random()*e.length)]}function k(e){for(let t=e.length-1;t>0;t--){const r=Math.floor(Math.random()*(t+1));[e[t],e[r]]=[e[r],e[t]]}return e}function h(){return m([()=>`${m($)}${s(10,9999)}`,()=>`${a()}${s(100,999)}-${a().toUpperCase()}`,()=>`${a()}${a()}-${s(10,99)}`,()=>`${s(1,9)}-${s(10,99)}${a().toUpperCase()}${a().toUpperCase()}`])()}const v="https://api.allorigins.win/get?url=";async function o(e,t=!1){try{const r=t?`${v}${encodeURIComponent(e)}`:e,n=await fetch(r);if(!n.ok)return null;const p=await n.json();return t?JSON.parse(p.contents):p}catch{return null}}const c={async ifixit(e){const t=await o(`https://www.ifixit.com/api/2.0/search/${encodeURIComponent(e)}?type=guide`);return t?.results?t.results.slice(0,5).map(r=>({source:"iFixit / Tech",url:r.image?.original||r.image?.standard,title:r.title,link:r.url})):[]},async marketplace(e){const t=await o(`https://duckduckgo.com/i.js?q=${encodeURIComponent(e+" product")}&o=json`,!0);return t?.results?t.results.slice(0,15).map(r=>({source:"Market / Web",url:r.image,title:r.title,link:r.url})):[]},async archive(e){const t=`https://archive.org/advancedsearch.php?q=${encodeURIComponent(e+" AND mediatype:image")}&fl[]=identifier&fl[]=title&rows=10&output=json&sort[]=random`,r=await o(t);return r?.response?.docs?r.response.docs.map(n=>({source:"Archive / Tech",url:`https://archive.org/services/img/${n.identifier}`,title:n.title,link:`https://archive.org/details/${n.identifier}`})):[]},async wiki(e){const t=`https://commons.wikimedia.org/w/api.php?action=query&generator=search&gsrsearch=${encodeURIComponent(e)}&gsrnamespace=6&gsrlimit=10&prop=imageinfo&iiprop=url|size|extmetadata&format=json&origin=*`,r=await o(t);return r?.query?.pages?Object.values(r.query.pages).map(n=>({source:"Wikimedia",url:n.imageinfo?.[0]?.url,title:n.title?.replace("File:",""),link:n.imageinfo?.[0]?.descriptionurl})):[]}};async function u(){if(l.length>3||d)return;d=!0;const e=h(),t={token:e,items:[]};(await Promise.allSettled(Object.keys(c).map(n=>c[n](e)))).forEach(n=>{n.status==="fulfilled"&&(t.items=[...t.items,...n.value])}),t.items.length>0&&l.push(t),d=!1,setTimeout(u,500)}async function g(){if(l.length>0){const n=l.shift();i.btn.innerText=n.token,i.grid.innerHTML="",f(n.items),i.loader.classList.add("hidden"),u();return}i.loader.classList.remove("hidden");let e=i.btn.innerText;(e==="???"||e==="DSC_0000")&&(e=h(),i.btn.innerText=e),i.grid.innerHTML="";const t=await Promise.allSettled(Object.keys(c).map(n=>c[n](e)));let r=[];t.forEach(n=>{n.status==="fulfilled"&&(r=[...r,...n.value])}),f(r),i.loader.classList.add("hidden"),u()}function f(e){k(e),!(!e||e.length===0)&&e.forEach(t=>{if(!t.url)return;const r=`https://wsrv.nl/?url=${encodeURIComponent(t.url)}&w=1000&q=85&output=webp`,n=document.createElement("div");n.className="grid-item",n.innerHTML=`
            <a href="${t.link}" target="_blank">
                <img src="${r}" alt="${t.title}" loading="lazy" onerror="this.closest('.grid-item').remove()">
            </a>
            <div class="caption-overlay">
                <div class="item-meta">
                    <span class="badg">[${t.source.split(" ")[0]}]</span> ${t.title.substring(0,40)}
                </div>
            </div>
        `,i.grid.appendChild(n)})}i.btn.addEventListener("click",g);window.addEventListener("load",()=>{u(),g()});
