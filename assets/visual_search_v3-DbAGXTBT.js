import"./modulepreload-polyfill-B5Qt9EMX.js";const o={btn:document.getElementById("ignite-btn"),grid:document.getElementById("grid-container"),loader:document.getElementById("loader")},k=["STM32","ESP32","LM","TPS","MAX","ADS","INA","LTC","BME","V","SX","DRV","AT","BC","2N","NE"];let u=[],f=!1;function l(r,t){return Math.floor(Math.random()*(t-r)+r)}function c(){return String.fromCharCode(97+Math.floor(Math.random()*26))}function v(r){return r[Math.floor(Math.random()*r.length)]}function j(r){for(let t=r.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[r[t],r[i]]=[r[i],r[t]]}return r}function s(){return v([()=>`${v(k)}${l(10,9999)}`,()=>`${c()}${l(100,999)}-${c().toUpperCase()}`,()=>`${c()}${c()}-${l(10,99)}`,()=>`${l(1,9)}-${l(10,99)}${c().toUpperCase()}${c().toUpperCase()}`])()}const R="https://api.allorigins.win/get?url=";async function m(r,t=!1){try{const i=t?`${R}${encodeURIComponent(r)}`:r,n=await fetch(i);if(!n.ok)return null;const e=await n.json();return t?JSON.parse(e.contents):e}catch{return null}}const h={async ifixit(r){const t=await m(`https://www.ifixit.com/api/2.0/search/${encodeURIComponent(r)}?type=guide`);return t?.results?t.results.slice(0,5).map(i=>({source:"iFixit",url:i.image?.original||i.image?.standard,title:i.title,link:i.url})):[]},async marketplace(r){const t=`${r} electronic hardware component -book -movie -religion -manuscript`,i=await m(`https://duckduckgo.com/i.js?q=${encodeURIComponent(t)}&o=json`,!0);return i?.results?i.results.slice(0,15).map(n=>({source:"Market/Web",url:n.image,title:n.title,link:n.url})):[]},async archive(r){const t=`https://archive.org/advancedsearch.php?q=${encodeURIComponent(r+" AND (subject:hardware OR subject:electronics OR subject:machinery) AND -mediatype:texts AND -subject:religion")}&fl[]=identifier&fl[]=title&rows=15&output=json&sort[]=random`,i=await m(t);return i?.response?.docs?i.response.docs.map(n=>{const e=n.identifier;return{source:"Archive",url:`https://archive.org/download/${e}/${e}.jpg`,fallbackUrl:`https://archive.org/services/img/${e}`,title:n.title,link:`https://archive.org/details/${e}`}}):[]},async wiki(r){const t=`${r} electronics equipment`,i=`https://commons.wikimedia.org/w/api.php?action=query&generator=search&gsrsearch=${encodeURIComponent(t)}&gsrnamespace=6&gsrlimit=10&prop=imageinfo&iiprop=url|size|extmetadata&format=json&origin=*`,n=await m(i);return n?.query?.pages?Object.values(n.query.pages).map(e=>({source:"Wiki",url:e.imageinfo?.[0]?.url,title:e.title?.replace("File:",""),link:e.imageinfo?.[0]?.descriptionurl})):[]}};async function g(){if(u.length>500||f)return;f=!0;const t=[s(),s(),s(),s()].flatMap(n=>Object.keys(h).map(e=>{const a=e==="marketplace"?`${n} electronic hardware component -book -movie -religion -manuscript`:e==="archive"?`${n} AND (subject:hardware OR subject:electronics OR subject:machinery) AND -mediatype:texts AND -subject:religion`:e==="wiki"?`${n} electronics equipment`:n;return h[e](n).then(d=>(b(a,e,d?.length||0),d))}));(await Promise.allSettled(t)).forEach(n=>{n.status==="fulfilled"&&n.value&&(u=[...u,...n.value])}),f=!1,setTimeout(g,1e3)}const p=[];function b(r,t,i){o.log||(o.log=document.createElement("div"),o.log.className="debug-log",document.body.appendChild(o.log));const n={time:new Date().toLocaleTimeString().split(" ")[0],token:r,source:t,count:i};p.unshift(n),p.length>15&&p.pop(),o.log.innerHTML=p.map(e=>`
        <div class="log-entry">[${e.time}] ${e.token.substring(0,10)}.. > ${e.source} (${e.count})</div>
    `).join("")}async function y(){if(o.grid.innerHTML="",o.loader.classList.remove("hidden"),u.length>30){const e=u.splice(0,100);w(e),o.loader.classList.add("hidden"),g();return}const t=[s(),s(),s()].flatMap(e=>Object.keys(h).map(a=>{const d=a==="marketplace"?`${e} electronic hardware component -book -movie -religion -manuscript`:a==="archive"?`${e} AND (subject:hardware OR subject:electronics OR subject:machinery) AND -mediatype:texts AND -subject:religion`:a==="wiki"?`${e} electronics equipment`:e;return h[a](e).then($=>(b(d,a,$?.length||0),$))})),i=await Promise.allSettled(t);let n=[];i.forEach(e=>{e.status==="fulfilled"&&e.value&&(n=[...n,...e.value])}),w(n),o.loader.classList.add("hidden"),g()}function w(r){j(r),r.forEach(t=>{if(!t.url)return;const i=`https://wsrv.nl/?url=${encodeURIComponent(t.url)}&w=1200&q=90&output=webp`,n=document.createElement("div");n.className="grid-item";const e=t.source==="Archive"?`this.src='https://wsrv.nl/?url=${encodeURIComponent(t.fallbackUrl)}&w=1200&q=90&output=webp';this.onerror=function(){this.closest('.grid-item').remove()}`:"this.closest('.grid-item').remove()";n.innerHTML=`
            <a href="${t.link}" target="_blank">
                <img src="${i}" alt="${t.title}" loading="lazy" onerror="${e}">
            </a>
            <div class="caption-overlay">
                <div class="item-meta">
                    <span class="badg">[${t.source}]</span> ${t.title.substring(0,40)}
                </div>
            </div>
        `,o.grid.appendChild(n)})}o.btn.addEventListener("click",y);window.addEventListener("load",()=>{g().then(()=>{y()})});
