import"./modulepreload-polyfill-B5Qt9EMX.js";import{r as x,j as n,U as Ze,R as Qe,S as Je,B as et,E as tt,M as st,T as nt,a as at,F as rt,c as it}from"./undo-2-CZBdDF7N.js";const ot=()=>{const B=x.useRef(null),[f,D]=x.useState(new Set),[ce,q]=x.useState(!1),[b,K]=x.useState([]),[E,U]=x.useState([]),[R,Se]=x.useState(.4),[P,Pe]=x.useState(.7),[v,Ne]=x.useState(1),[N,I]=x.useState("brush"),[O,de]=x.useState(new Set),[T,he]=x.useState([]),[V,xe]=x.useState(new Map),[C,$e]=x.useState("random"),[L,ke]=x.useState(12345),[j,Ce]=x.useState(1),[Z,G]=x.useState(null),[H,ue]=x.useState(null),[Me,Ee]=x.useState(0),[Re,Te]=x.useState(0),[Le,fe]=x.useState(!1),[p,He]=x.useState(32),[y,We]=x.useState(32),[ge,ze]=x.useState("smooth-pixels"),Q=700,X=2,_e=(e,a,l,o)=>{const r=[],s=Math.abs(l-e),t=Math.abs(o-a),c=e<l?1:-1,d=a<o?1:-1;let i=s-t;for(;r.push({x:e,y:a}),!(e===l&&a===o);){const h=2*i;h>-t&&(i-=t,e+=c),h<s&&(i+=s,a+=d)}return r},S=x.useCallback(()=>{const e=p*j,l=Q/Math.max(e,y),o=l*j,r=l,s=Math.round(p*o),t=Math.round(y*r);return{visualPixelWidth:o,visualPixelHeight:r,scaleFactor:l,displayWidth:s,displayHeight:t}},[p,y,j]),me=(e,a)=>{const l=B.current;if(!l)return{x:0,y:0};const o=l.getBoundingClientRect(),{visualPixelWidth:r,visualPixelHeight:s}=S(),t=e-o.left,c=a-o.top,d=t,i=c,h=Math.floor(d/r),u=Math.floor(i/s);return{x:h,y:u}},J=(e,a)=>{D(l=>{const o=new Set(l),r=Math.floor(v/2);return e.forEach(s=>{for(let t=0;t<v;t++)for(let c=0;c<v;c++){const d=s.x+c-r,i=s.y+t-r;d>=0&&d<p&&i>=0&&i<y&&(a==="brush"?o.add(`${d},${i}`):o.delete(`${d},${i}`))}}),o})},pe=()=>{if(b.length>0){const a=b[b.length-1];if(a.size===f.size&&[...a].every(l=>f.has(l)))return}const e=[...b,new Set(f)].slice(-50);K(e),U([])},ee=x.useCallback(()=>{if(b.length===0)return;const e=b[b.length-1],a=b.slice(0,-1);U(l=>[new Set(f),...l]),D(e),K(a),G(null)},[b,f]),te=x.useCallback(()=>{if(E.length===0)return;const e=E[0],a=E.slice(1);K(l=>[...l,new Set(f)]),D(e),U(a)},[E,f]);x.useEffect(()=>{const e=a=>{(a.metaKey||a.ctrlKey)&&a.key==="z"&&(a.preventDefault(),a.shiftKey?te():ee()),a.key==="b"&&I("brush"),a.key==="e"&&I("eraser")};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[ee,te]);const Fe=e=>{e.target.setPointerCapture(e.pointerId),e.preventDefault();const l=e.metaKey||e.ctrlKey?N==="brush"?"eraser":"brush":N;pe(),q(!0);const{x:o,y:r}=me(e.clientX,e.clientY);if(ue({x:o,y:r}),e.shiftKey&&Z&&N==="brush"){const s=_e(Z.x,Z.y,o,r);J(s,l)}else J([{x:o,y:r}],l);G({x:o,y:r})},Ae=e=>{const{visualPixelWidth:a,visualPixelHeight:l}=S();if(!B.current)return;let{x:r,y:s}=me(e.clientX,e.clientY);if(ce&&e.shiftKey&&H){const h=Math.abs(r-H.x),u=Math.abs(s-H.y);h>u?s=H.y:r=H.x}const t=r*a,c=s*l;if(Ee(t),Te(c),!ce)return;e.preventDefault();const i=e.metaKey||e.ctrlKey?N==="brush"?"eraser":"brush":N;J([{x:r,y:s}],i),G({x:r,y:s})},Be=e=>{q(!1),ue(null),e.target.releasePointerCapture(e.pointerId)},W=x.useCallback(()=>{const e=[],a=(r,s)=>f.has(`${r},${s}`);if(f.forEach(r=>{const[s,t]=r.split(",").map(Number);s>=p||t>=y||s<0||t<0||(a(s,t-1)||e.push({x1:s,y1:t,x2:s+1,y2:t,side:"top"}),a(s+1,t)||e.push({x1:s+1,y1:t,x2:s+1,y2:t+1,side:"right"}),a(s,t+1)||e.push({x1:s+1,y1:t+1,x2:s,y2:t+1,side:"bottom"}),a(s-1,t)||e.push({x1:s,y1:t+1,x2:s,y2:t,side:"left"}))}),e.length===0)return[];const l=[],o=new Set;for(let r=0;r<e.length;r++){if(o.has(r))continue;const s=[e[r]];o.add(r);let t=e[r];for(;;){let c=!1;for(let d=0;d<e.length;d++){if(o.has(d))continue;const i=e[d];if(Math.abs(t.x2-i.x1)<.01&&Math.abs(t.y2-i.y1)<.01){s.push(i),o.add(d),t=i,c=!0;break}}if(!c||Math.abs(t.x2-s[0].x1)<.01&&Math.abs(t.y2-s[0].y1)<.01)break}s.length>2&&l.push(s)}return l},[f,p,y]),De=(e,a)=>{const l=e.x2-e.x1,o=e.y2-e.y1,r=a.x2-a.x1,s=a.y2-a.y1;return l*s-o*r>0?"convex":"concave"},se=(e,a,l)=>{const o=Math.sin(e*12.9898+a*78.233+l*43758.5453)*43758.5453;return o-Math.floor(o)},ye=(e,a,l,o=!1)=>{const{visualPixelWidth:r,visualPixelHeight:s}=S(),t=a.X*r,c=a.Y*s,d=Math.min(r,s),i=Math.min(l,d*.5);let h,u,m,g;return a.quadrant==="TR_GAP_FILLET"?(h=t,u=c-i,m=t+i,g=c):a.quadrant==="BL_GAP_FILLET"?(h=t-i,u=c,m=t,g=c+i):a.quadrant==="BR_GAP_FILLET"?(h=t+i,u=c,m=t,g=c+i):a.quadrant==="TL_GAP_FILLET"&&(h=t,u=c-i,m=t-i,g=c),h===void 0?o?"":null:o?`M ${h} ${u} Q ${t} ${c} ${m} ${g} L ${t} ${c} Z `:(e.moveTo(h,u),e.quadraticCurveTo(t,c,m,g),e.lineTo(t,c),e.lineTo(h,u),null)},be=x.useCallback(()=>{const e=W(),a=new Set;e.forEach((r,s)=>{r.forEach((t,c)=>{const d=r[(c+1)%r.length],i=De(t,d);if(C==="outer"&&i!=="convex"||C==="inner"&&i!=="concave")return;se(t.x2,t.y2,L)<P&&a.add(`${s}-${c}`)})}),de(a);const l=[],o=new Map;if(C!=="outer"&&f.size>0){const r=(s,t)=>f.has(`${s},${t}`);for(let s=1;s<p;s++)for(let t=1;t<y;t++){const c=r(s-1,t-1),d=r(s,t-1),i=r(s-1,t),h=r(s,t);c&&h&&!d&&!i&&se(s,t,L+1)<P&&(l.push({X:s,Y:t,quadrant:"TR_GAP_FILLET"}),l.push({X:s,Y:t,quadrant:"BL_GAP_FILLET"}),o.set(`${s},${t}`,!0)),d&&i&&!c&&!h&&se(s,t,L+2)<P&&(l.push({X:s,Y:t,quadrant:"BR_GAP_FILLET"}),l.push({X:s,Y:t,quadrant:"TL_GAP_FILLET"}),o.set(`${s},${t}`,!0))}}he(l),xe(o)},[W,C,P,L,f,p,y]);x.useEffect(()=>{be()},[f,P,C,L,be]);const ve=x.useCallback((e,a=!1)=>{const{visualPixelWidth:l,visualPixelHeight:o,displayWidth:r,displayHeight:s}=S();if(e.fillStyle="#ffffff",e.fillRect(0,0,r,s),!a){e.beginPath(),e.strokeStyle="#e5e7eb",e.lineWidth=.5;for(let i=0;i<=p;i++){const h=i*l;e.moveTo(h,0),e.lineTo(h,s)}for(let i=0;i<=y;i++){const h=i*o;e.moveTo(0,h),e.lineTo(r,h)}e.stroke()}if(f.size===0)return;const t=W(),c=Math.min(l,o),d=R*c;e.fillStyle="#000000",e.beginPath(),t.forEach((i,h)=>{i.length>0&&e.moveTo(i[0].x1*l,i[0].y1*o),i.forEach((u,m)=>{const g=i[(m+1)%i.length],w=u.x2*l,M=u.y2*o,re=u.x2,Y=u.y2;let z=O.has(`${h}-${m}`);if(V.has(`${re},${Y}`)&&(z=!1),z&&d>0){const _=u.x2-u.x1,F=u.y2-u.y1,A=g.x2-g.x1,$=g.y2-g.y1,k=Math.min(d,c*.5),ie=w-(_!==0?Math.sign(_)*k:0),oe=M-(F!==0?Math.sign(F)*k:0),le=w+(A!==0?Math.sign(A)*k:0),Ve=M+($!==0?Math.sign($)*k:0);e.lineTo(ie,oe),e.arcTo(w,M,le,Ve,k)}else e.lineTo(w,M)}),e.closePath()}),T.length>0&&d>0&&T.forEach(i=>ye(e,i,d*c,!1)),e.fill("evenodd")},[p,y,f,W,R,O,V,T,S]),{displayWidth:ne,displayHeight:ae}=S();x.useEffect(()=>{const e=B.current;if(!e)return;const a=e.getContext("2d");e.width=ne*X,e.height=ae*X,a.scale(X,X),ve(a,!1)},[ve,ne,ae]);const Ie=()=>{const{visualPixelWidth:e,visualPixelHeight:a,displayWidth:l,displayHeight:o}=S(),r=W(),s=Math.min(e,a),t=R*s;let c="";return r.forEach((d,i)=>{d.length!==0&&(c+=`M ${d[0].x1*e} ${d[0].y1*a} `,d.forEach((h,u)=>{const m=d[(u+1)%d.length],g=h.x2*e,w=h.y2*a,M=h.x2,re=h.y2;let Y=O.has(`${i}-${u}`);if(V.has(`${M},${re}`)&&(Y=!1),Y&&t>0){const z=h.x2-h.x1,_=h.y2-h.y1,F=m.x2-m.x1,A=m.y2-m.y1,$=Math.min(t,s*.5),k=g-(z!==0?Math.sign(z)*$:0),ie=w-(_!==0?Math.sign(_)*$:0),oe=g+(F!==0?Math.sign(F)*$:0),le=w+(A!==0?Math.sign(A)*$:0);c+=`L ${k} ${ie} `,c+=`Q ${g} ${w} ${oe} ${le} `}else c+=`L ${g} ${w} `}),c+="Z ")}),T.length>0&&t>0&&T.forEach(d=>{c+=ye(null,d,t,!0)}),`
<svg width="${l}" height="${o}" viewBox="0 0 ${l} ${o}" xmlns="http://www.w3.org/2000/svg">
<rect width="100%" height="100%" fill="white"/>
<path d="${c}" fill="black" fill-rule="evenodd"/>
</svg>
`.trim()},Ge=()=>{const e=Ie(),a=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),l=URL.createObjectURL(a),o=document.createElement("a");o.href=l,o.download=`${ge||"smooth-pixels"}.svg`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(l)},Xe=()=>{pe(),D(new Set),de(new Set),he([]),xe(new Map),G(null)},{visualPixelWidth:we,visualPixelHeight:je}=S(),Ye=v*we,qe=v*je,Ke=Math.floor(v/2)*we,Ue=Math.floor(v/2)*je,Oe={width:`${Ye}px`,height:`${qe}px`,left:`${Me-Ke}px`,top:`${Re-Ue}px`,borderColor:"white",backgroundColor:"transparent",mixBlendMode:"difference",borderRadius:"2px",borderWidth:"1px",borderStyle:"solid",transition:"width 0.1s, height 0.1s"};return n.jsxs("div",{className:"flex flex-col lg:flex-row items-start justify-center gap-8 p-4 lg:p-8 bg-gray-50 min-h-screen font-sans text-gray-900",children:[n.jsxs("div",{className:"flex flex-col items-center flex-none",children:[n.jsx("h1",{className:"text-3xl font-extrabold mb-2 tracking-tight text-center uppercase",children:"Smooth Pixels 2.0"}),n.jsx("p",{className:"text-sm text-gray-500 mb-6 text-center max-w-md",children:"Shift+Click for Lines. Shift+Drag for Orthogonal."}),n.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-4 w-full max-w-[700px] justify-between",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx("button",{onClick:ee,disabled:b.length===0,className:"p-2 rounded border border-gray-200 bg-white hover:bg-gray-100 disabled:opacity-30 transition shadow-sm text-gray-900",children:n.jsx(Ze,{size:18})}),n.jsx("button",{onClick:te,disabled:E.length===0,className:"p-2 rounded border border-gray-200 bg-white hover:bg-gray-100 disabled:opacity-30 transition shadow-sm text-gray-900",children:n.jsx(Qe,{size:18})})]}),n.jsxs("div",{className:"flex items-center gap-1 bg-white px-3 py-1.5 rounded border border-gray-200 shadow-sm",children:[n.jsx(Je,{size:14,className:"text-gray-500 mr-1"}),n.jsx("input",{type:"number",min:"4",max:"128",step:"1",value:p,onChange:e=>He(Number(e.target.value)),className:"bg-transparent w-8 text-sm font-bold outline-none text-gray-900 text-right"}),n.jsx("span",{className:"text-xs text-gray-400",children:"x"}),n.jsx("input",{type:"number",min:"4",max:"128",step:"1",value:y,onChange:e=>We(Number(e.target.value)),className:"bg-transparent w-8 text-sm font-bold outline-none text-gray-900 text-right"}),n.jsx("span",{className:"text-xs font-medium text-gray-500 ml-1",children:"px"})]})]}),n.jsx("div",{className:"flex items-center justify-center select-none",style:{minWidth:`${Q+32}px`,minHeight:`${Q+32}px`},children:n.jsxs("div",{className:"relative shadow-xl border-3 border--100 overflow-hidden bg-white",style:{width:`${ne}px`,height:`${ae}px`},children:[Le&&n.jsx("div",{className:"absolute z-10 pointer-events-none transition-transform duration-50",style:Oe}),n.jsx("canvas",{ref:B,className:"block touch-none",style:{width:"100%",height:"100%"},onPointerDown:Fe,onPointerMove:Ae,onPointerUp:Be,onPointerLeave:()=>{q(!1),fe(!1)},onPointerEnter:()=>fe(!0)})]})}),n.jsxs("div",{className:"mt-2 text-xs text-gray-400 font-medium",children:[j>1?"Wide Pixels":j<1?"Tall Pixels":"Square Pixels"," (Ratio: ",j.toFixed(2),")"]})]}),n.jsxs("div",{className:"w-full max-w-sm flex flex-col gap-5 pt-2",children:[n.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-lg",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Tools"}),n.jsxs("div",{className:"flex gap-2 mb-4",children:[n.jsxs("button",{onClick:()=>I("brush"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-sm font-medium transition ${N==="brush"?"bg-black text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[n.jsx(et,{size:16})," Draw"]}),n.jsxs("button",{onClick:()=>I("eraser"),className:`flex-1 py-2 rounded-lg flex items-center justify-center gap-2 text-sm font-medium transition ${N==="eraser"?"bg-black text-white shadow-md":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[n.jsx(tt,{size:16})," Erase"]})]}),n.jsxs("div",{className:"mb-4 space-y-3",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between items-center mb-1",children:[n.jsx("span",{className:"text-xs font-medium text-gray-500",children:"Brush Size"}),n.jsx("span",{className:"text-xs font-mono bg-gray-100 px-2 py-1 rounded text-gray-600",children:v})]}),n.jsx("input",{type:"range",min:"1",max:"6",step:"1",value:v,onChange:e=>Ne(parseInt(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-black"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between items-center mb-1",children:[n.jsxs("span",{className:"text-xs font-medium text-gray-500 flex items-center gap-1",children:[n.jsx(st,{size:10})," Pixel Ratio"]}),n.jsx("span",{className:"text-xs font-mono bg-gray-100 px-2 py-1 rounded text-gray-600",children:j.toFixed(2)})]}),n.jsx("input",{type:"range",min:"0.25",max:"3",step:"0.25",value:j,onChange:e=>Ce(parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-black"})]})]}),n.jsxs("button",{onClick:Xe,className:"w-full py-2 text-sm rounded border border-gray-200 text-gray-600 hover:bg-gray-50 hover:text-black transition flex items-center justify-center gap-2",children:[n.jsx(nt,{size:16})," Clear Canvas"]})]}),n.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-lg",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Smoothing"}),n.jsx("div",{className:"grid grid-cols-3 gap-2 mb-6",children:["random","outer","inner"].map(e=>n.jsx("button",{onClick:()=>$e(e),className:`py-2 px-1 text-xs font-bold rounded-md border transition-all capitalize ${C===e?"bg-black text-white border-black shadow-md":"bg-white text-gray-600 border-gray-200 hover:border-gray-300"}`,children:e==="random"?"Mixed":e==="outer"?"Convex":"Concave"},e))}),n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-2",children:[n.jsx("span",{children:"Smoothness"}),n.jsx("span",{className:"font-medium text-gray-900",children:R.toFixed(2)})]}),n.jsx("input",{type:"range",min:"0",max:"0.5",step:"0.01",value:R,onChange:e=>Se(parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-black"})]}),n.jsxs("div",{children:[n.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mb-2",children:[n.jsx("span",{children:"Probability"}),n.jsxs("span",{className:"font-medium text-gray-900",children:[Math.round(P*100),"%"]})]}),n.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:P,onChange:e=>Pe(parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-black"})]}),n.jsxs("button",{onClick:()=>ke(Math.random()),className:"w-full py-2 rounded-lg border border-gray-300 bg-white hover:bg-gray-50 text-gray-700 transition flex items-center justify-center gap-2 text-sm font-medium",children:[n.jsx(at,{size:16})," Shuffle Corners"]})]})]}),n.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-lg",children:[n.jsx("h3",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Export"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:ge,onChange:e=>ze(e.target.value),className:"flex-1 px-3 py-2 text-sm border border-gray-300 rounded-md focus:ring-1 focus:ring-black focus:border-black outline-none",placeholder:"filename"}),n.jsxs("button",{onClick:Ge,className:"px-4 py-2 rounded-lg bg-black text-white hover:bg-gray-800 transition flex items-center justify-center gap-2 text-sm font-semibold",children:[n.jsx(rt,{size:18})," Download SVG"]})]})]})]})]})};function lt(){return n.jsx("div",{className:"min-h-screen bg-gray-50",children:n.jsx(ot,{})})}it.createRoot(document.getElementById("root")).render(n.jsx(x.StrictMode,{children:n.jsx(lt,{})}));
